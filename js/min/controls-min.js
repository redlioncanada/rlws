function moveCamX(e){camera.position.x+=e,light.position.x+=e}function moveCamY(e){camera.position.y+=e,light.position.y+=e}function moveCamAbs(e,o){camera.position.y=o,light.position.y=o,camera.position.x=e,light.position.x=e}function boxClicked(e){console.log(e.name),$("#blackout").css({display:"block"}).animate({opacity:1},500),overlay=!0,$("#overlay").html("box clicked: "+e.name+"<br>Content title: "+glCards2[parseInt(e.name)].title+"<br>Description: "+glCards2[parseInt(e.name)].description+'<br>Image: <img src="'+glCards2[parseInt(e.name)].img+'">'),$("#blackout").on("click touchend",function(e){$(this).animate({opacity:0},500,function(){$("#blackout").css({display:"none"}),overlay=!1}),$(this).unbind("click")})}function fingerMouseDown(e){if(e.preventDefault(),isMobile)if(2==e.touches.length)console.log(e.touches);else{var o=e.touches[0];oldTouchX=o.pageX,oldTouchY=o.pageY}else oldTouchX=e.clientX,oldTouchY=e.clientY;mTouchDown=!0}function fingerMouseDrag(e){e.preventDefault();var o,n,t,i;if(isMobile){var a=e.touches[0];o=a.pageX-oldTouchX,t=a.pageX,n=a.pageY-oldTouchY,i=a.pageY}else mTouchDown&&(o=e.clientX-oldTouchX,t=e.clientX,n=e.clientY-oldTouchY,i=e.clientY);xMove!=o&&(xMove=o,oldTouchX=t,xMove>0&&(mLEFT=!0),0>xMove&&(mRIGHT=!0)),yMove!=n&&(yMove=n,oldTouchY=i,yMove>0&&(mDOWN=!0),0>yMove&&(mUP=!0))}function fingerMouseUp(e){e.preventDefault();var o,n,t;if(1>xMove&&xMove>-1&&1>yMove&&yMove>-1&&!pinched){isMobile?(o=e.pageX/window.innerWidth*2-1,n=2*-(e.pageY/window.innerHeight)+1,t=new THREE.Vector3(o,n,.5)):(o=e.clientX/window.innerWidth*2-1,n=2*-(e.clientY/window.innerHeight)+1,t=new THREE.Vector3(o,n,.5));var i=new THREE.Raycaster;t.unproject(camera),i.set(camera.position,t.sub(camera.position).normalize());var a=i.intersectObjects(objects);a.length>0&&boxClicked(a[0].object)}xMove=0,yMove=0,mUP=!1,mDOWN=!1,mRIGHT=!1,mDOWN=!1,mTouchDown=!1,oldScale=0,pinched=!1}function zoomHandler(e){var o=Math.max(-.1,Math.min(.1,e.wheelDelta||-e.detail));(camera.position.z>camMinHeight&&o>0||camera.position.z<camMaxHeight&&0>o)&&(camera.position.z-=o)}function resetPinches(){$(document).on("pinchstart",function(e){oldScale=0,pinched=!0}),$(document).on("pinchmove",function(e){pinched=!0;var o=e.scale-oldScale;oldScale=e.scale,camera.position.z<camMaxHeight&&0>o?(camera.position.z+=.1,console.log("zoom out, delta: "+o)):camera.position.z>camMinHeight&&o>0&&(camera.position.z-=.1,console.log("zoom in, delta: "+o))}),$(document).on("pinchend",function(e){oldScale=0,pinched=!1,$(document).off("pinchstart pinchmove pinchend"),resetPinches()})}function setupEventListeners(){var e=document.getElementsByTagName("canvas"),o=e[0];o.addEventListener("touchstart",fingerMouseDown),o.addEventListener("mousedown",fingerMouseDown),o.addEventListener("touchend",fingerMouseUp),o.addEventListener("mouseup",fingerMouseUp),o.addEventListener("touchmove",fingerMouseDrag),o.addEventListener("mousemove",fingerMouseDrag),o.addEventListener("mousewheel",zoomHandler)}var isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),mUP=!1,mDOWN=!1,mRIGHT=!1,mLEFT=!1,mGOIN=!1,mGOOUT=!1,mROTUP=!1,mROTDOWN=!1,oldTouchX=0,oldTouchY=0,xMove=0,yMove=0,mTouchDown=!1,mTouchMove=!1,overlay=!1,oldScale=0,pinched=!1;$(document).keydown(function(e){38==e.which&&(e.preventDefault(),console.log("camy:"+Math.abs(camera.position.y)+",constrain:"+Math.abs(originY+camY1Extents)),mUP=!0),40==e.which&&(e.preventDefault(),console.log("camy:"+Math.abs(camera.position.y)+",constrain:"+Math.abs(originY-camY2Extents)),mDOWN=!0),37==e.which&&(e.preventDefault(),console.log("camx:"+Math.abs(camera.position.x)+",constrain:"+Math.abs(originX-camX1Extents)),mLEFT=!0),39==e.which&&(e.preventDefault(),console.log("camx:"+Math.abs(camera.position.x)+",constrain:"+Math.abs(originX+camX2Extents)),mRIGHT=!0),34==e.which&&(e.preventDefault(),mGOIN=!0),33==e.which&&(e.preventDefault(),mGOOUT=!0),36==e.which&&(e.preventDefault(),mROTUP=!0),35==e.which&&(e.preventDefault(),mROTDOWN=!0)}),$(document).keyup(function(e){38==e.which&&(e.preventDefault(),mUP=!1),40==e.which&&(e.preventDefault(),mDOWN=!1),37==e.which&&(e.preventDefault(),mLEFT=!1),39==e.which&&(e.preventDefault(),mRIGHT=!1),34==e.which&&(e.preventDefault(),mGOIN=!1),33==e.which&&(e.preventDefault(),mGOOUT=!1),36==e.which&&(e.preventDefault(),mROTUP=!1),35==e.which&&(e.preventDefault(),mROTDOWN=!1)}),resetPinches();