var glCards=[],boxid,app=angular.module("redLion",["ngRoute"]);app.config(["$routeProvider",function(e){e.when("/grid",{template:" ",controller:"GridControler"}).when("/work/:campaignID/:subSection",{templateUrl:"templates/work.html",controller:"WorkCtrl"}).when("/people/:staffID",{templateUrl:"templates/people.html",controller:"PeopleCtrl"}).otherwise({redirectTo:"/grid"})}]),app.controller("CardTestController",function(e,t,o){e.cards=t.get(),init3D()}),app.controller("GridControler",function(e){console.log("grid connection")}),app.controller("WorkCtrl",["$scope","$routeParams","$sce","$timeout",function(e,t,o,n){e.campaignID=t.campaignID,e.startSection=t.subSection,e.work=dataController.GetByID(boxid),e.work.date_launched=Date.parse(e.work.date_launched);for(var r=e.work.video_comsep,i=0;i<r.length;i++)""!==e.work.video_comsep[i]&&(e.work.video_comsep[i]=o.trustAsResourceUrl(e.work.video_comsep[i]));console.log("Campaign ID = "+e.campaignID),console.log("subSection = "+e.startSection),console.log(e.work),closeButtonStart();var a={dots:!0,infinite:!0,speed:500,slidesToShow:1,adaptiveHeight:!0};""!==e.work.print_comsep[0]&&n(function(){$(".printwork").slick(a)},500),""!==e.work.digital_comsep[0]&&n(function(){$(".digitalwork").slick(a)},500)}]),app.controller("PeopleCtrl",["$scope","$routeParams","$http","$animate",function(e,t,o,n){e.people=[],console.log("Person Slug = "+t.staffID),closeButtonStart(),o.get("http://redlioncanada.com/api/content/type/people").success(function(o){for(var n=0;n<o.length;n++)e.people.push(o[n]),o[n].slug==t.staffID&&(e.selperson=o[n])}).error(function(e){alert("ERROR: "+e)})}]),app.directive("peopleTile",function(){return{template:function(e,t){return'<img src="img/staff/'+t.peopleTile+'-tile.jpg" class="under"><img src="img/staff/'+t.peopleTile+'-tile-red.jpg" class="cover">'},link:function(e,t,o){t.on("mouseenter",function(){t.children("img.cover").addClass("hovered")}).on("mouseleave",function(){t.children("img.cover").removeClass("hovered")})}}}),app.factory("Cards",function(e){var t=[];return{get:function(){return 0===t.length&&e.get("http://redlioncanada.com/api/content/").success(function(e){for(var o=0,n=e.length;n>o;o++)t.push(e[o])}).error(function(e){alert("ERROR: "+e)}),glCards=t,t}}});var closeButtonStart=function(){$(".close").on("click",function(e){e.preventDefault(),$("#blackout").animate({opacity:0,"padding-top":50},1e3,"easeInCubic",function(){$(this).css({display:"none"}),window.location.href="#/grid"})})},audioPlayerStart=function(){var e=document.getElementsByClassName("audio_file");$(".play-pause-btn").click(function(){var e=$(this).siblings("audio").get(0);e.paused?(e.play(),$(this).attr("src","img/pause-btn.gif")):(e.pause(),$(this).attr("src","img/play-btn.gif"))}),$(".rwd-btn").click(function(){var e=$(this).siblings("audio").get(0);e.currentTime=0}),$(".ffwd-btn").click(function(){var e=$(this).siblings("audio").get(0);e.currentTime+=5});for(var t=0;t<e.length;t++){var o=e[t];setTimeout(audioLoadTimeout,200,o),o.addEventListener("timeupdate",function(e){var t=$(o).siblings("div.meter")[0],n=$(t).children("span")[0],r=o.currentTime/o.duration*100;$(n).css("width",r+"%");var i=$(o).siblings(".time-readout")[0],a=$(i).children(".audioCurrent")[0];$(a).text(getMinSec(o.currentTime))},!1),o.addEventListener("ended",function(e){o.pause()},!1)}},audioLoadTimeout=function(e){var t=$(e).siblings(".time-readout")[0],o=$(t).children(".audioTotal")[0];$(o).text(getMinSec(e.duration))},getMinSec=function(e){var t=Math.floor(e/60),o=parseInt(e-60*t);return 10>o&&(o="0"+o),t+":"+o};