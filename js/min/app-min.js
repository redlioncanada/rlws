var glCards=[],boxid=0,loadInterval,app=angular.module("redLion",["ngRoute"]);app.config(["$routeProvider",function(t){t.when("/grid",{template:" ",controller:"GridControler"}).when("/work/:campaignID/:subSection",{templateUrl:"templates/work.html",controller:"WorkCtrl"}).when("/disciplines/:disciplineID",{templateUrl:"templates/discipline.html",controller:"DisciplineCtrl"}).otherwise({redirectTo:"/grid"})}]),app.controller("CardTestController",function(t,e,i){t.cards=e.get(),init3D()}),app.factory("Cards",function(t){var e=[];return{get:function(){return 0===e.length&&t.get("http://redlioncanada.com/api/content/").success(function(t){for(var i=0,n=t.length;n>i;i++)e.push(t[i])}).error(function(t){alert("ERROR: "+t)}),glCards=e,e}}}),app.controller("GridControler",function(t){console.log("grid connection")}),app.controller("WorkCtrl",["$scope","$routeParams","$sce","$timeout",function(t,e,i,n){t.campaignID=e.campaignID,t.startSection=e.subSection,0!==boxid?getWorkData(t,i,n):loadInterval=setInterval(function(){dataController.GetBySlug(t.campaignID)!==!1&&(getWorkData(t,i,n,!0),clearInterval(loadInterval))},500)}]);var audioPlayerStart=function(){var t=document.getElementsByClassName("audio_file");$(".play-pause-btn").click(function(){var t=$(this).siblings("audio").get(0);t.paused?(t.play(),$(this).attr("src","img/pause-btn.gif")):(t.pause(),$(this).attr("src","img/play-btn.gif"))}),$(".rwd-btn").click(function(){var t=$(this).siblings("audio").get(0);t.currentTime=0}),$(".ffwd-btn").click(function(){var t=$(this).siblings("audio").get(0);t.currentTime+=5});for(var e=0;e<t.length;e++){var i=t[e];setTimeout(audioLoadTimeout,200,i),i.addEventListener("timeupdate",function(t){var e=$(i).siblings("div.meter")[0],n=$(e).children("span")[0],o=i.currentTime/i.duration*100;$(n).css("width",o+"%");var a=$(i).siblings(".time-readout")[0],r=$(a).children(".audioCurrent")[0];$(r).text(getMinSec(i.currentTime))},!1),i.addEventListener("ended",function(t){i.pause()},!1)}},audioLoadTimeout=function(t){var e=$(t).siblings(".time-readout")[0],i=$(e).children(".audioTotal")[0];$(i).text(getMinSec(t.duration))},getMinSec=function(t){var e=Math.floor(t/60),i=parseInt(t-60*e);return 10>i&&(i="0"+i),e+":"+i},getWorkData=function(t,e,i,n){t.work=n?dataController.GetBySlug(t.campaignID):dataController.GetByID(boxid),$("#blackout").css({display:"block"}),$("#blackout").animate({opacity:1,"padding-top":0},1e3,"easeOutCubic"),t.work.date_launched=Date.parse(t.work.date_launched);for(var o=t.work.video_comsep,a=0;a<o.length;a++)""!==t.work.video_comsep[a]&&(t.work.video_comsep[a]=e.trustAsResourceUrl(t.work.video_comsep[a]));closeButtonStart(),audioPlayerStart();var r={dots:!0,infinite:!0,speed:500,slidesToShow:1,adaptiveHeight:!0};""!==t.work.print_comsep[0]&&i(function(){$(".printwork").slick(r)},500),""!==t.work.digital_comsep[0]&&i(function(){$(".digitalwork").slick(r)},500)};app.controller("DisciplineCtrl",["$scope","$routeParams","$timeout",function(t,e,i){t.dslug=e.disciplineID,$("#blackout").css({display:"block"}),$("#blackout").animate({opacity:1,"padding-top":0},1e3,"easeOutCubic"),closeButtonStart(),0!==boxid?t.disciplines=dataController.GetByType("disciplines"):i(function(){t.disciplines=dataController.GetByType("disciplines")},1e3),i(function(){$(".dcontainer."+t.dslug+" p").slideDown(),$(".dcontainer."+t.dslug+" h1").addClass("selected"),$(".dcontainer."+t.dslug+" h1 span").html("-"),$(".dcontainer h1").click(function(){$(this).hasClass("selected")||($(".dcontainer p").slideUp(),$(".dcontainer h1").removeClass("selected"),$(".dcontainer h1 span").html("+"),$(this).addClass("selected"),$(this).children("span").html("-"),$(this).siblings("p").slideDown())})},1200)}]);var closeButtonStart=function(){$(".close").on("click",function(t){t.preventDefault(),$("#blackout").animate({opacity:0,"padding-top":50},1e3,"easeInCubic",function(){$(this).css({display:"none"}),window.location.href="#/grid"})})};