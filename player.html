<html ng-app="redLion">
	<head>
		<title>player control</title>
		<link rel="stylesheet" href="css/style.css?v=1.0">
		<link rel="stylesheet" href="css/slick.css"/>
		<link rel="stylesheet" href="css/slick-theme.css"/>
	</head>
	<body>
		<div id="overlay">
			<div class="player" id="player1">
				<div class="controlbox">
					<img src="img/rwd.gif" class="rwd-btn">
					<img src="img/play-btn.gif" class="play-pause-btn">
					<img src="img/ffwd-btn.gif" class="ffwd-btn">
					<div class="meter">
						<span style="width: 1%"></span>
					</div>
					<div class="time-readout">
						<span class="audioCurrent">0:00</span> / <span class="audioTotal">0:00</span>
					</div>
					<audio src="overworld.mp3" class="audio_file"></audio>
				</div>
			</div>
		</div>
		
		<script src="js/lib/three.min.js"></script>
		<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
		<script src="js/jquery-ui.min.js"></script>
		<script src="js/lib/slick.min.js"></script>
		<script src="js/min/pinch.min.js"></script>
		<script src="js/lib/angular.min.js"></script>
        <script src="js/lib/angular-route.min.js"></script>
        <script src="js/lib/angular-resource.min.js"></script>
        <script src="js/lib/angular-animate.min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/mathjs/1.3.0/math.min.js"></script>
		<script src="js/lib/dat.gui.min.js"></script>
		<script src="js/detector.js"></script>
		<script src="js/lib/tween.min.js"></script>
		<script src="js/lib/fuse.min.js"></script>
		<script src="js/lib/tween.min.js"></script>
		<script src="js/lib/fuse.min.js"></script>
		<script src="js/lib/BokehShader.js"></script>
		<script src="js/lib/threex.depthoffield.js"></script>
		<script src="js/lib/threex.depthoffielddatgui.js"></script>
		<script src="js/objects.js"></script>
		<script src="js/options.js"></script>
		<script src="js/app.js"></script>
		<script src="js/controls.js"></script>
		<script src="js/main.js"></script>
		<script src="js/ui.js"></script>
		<script src="js/overlay.js"></script>
		<script src="//use.typekit.net/ngi3tcl.js"></script>
		<script>try{Typekit.load();}catch(e){}</script>
		
		<script>
			$(function() {
				var audioplayers = document.getElementsByClassName('audio_file');
				
				$('.play-pause-btn').click(function() {
					var audioplayer = $(this).siblings('audio').get(0);
					if (audioplayer.paused) {
						audioplayer.play();
						$(this).attr('src', 'img/pause-btn.gif');
					} else {
						audioplayer.pause();
						$(this).attr('src', 'img/play-btn.gif');
					}
				});
				
				$('.rwd-btn').click(function() {
					var audioplayer = $(this).siblings('audio').get(0);
					audioplayer.currentTime = 0;
				});
				
				$('.ffwd-btn').click(function() {
					var audioplayer = $(this).siblings('audio').get(0);
					audioplayer.currentTime += 5;
				});
								
				for (var aps = 0; aps < audioplayers.length; aps++) {
					var media = audioplayers[aps];
					
					setTimeout(function(e) {
						var timediv = $(media).siblings('.time-readout')[0];
						var audioDurTime = $(timediv).children('.audioTotal')[0];
						$(audioDurTime).text(getMinSec(media.duration));
						console.log(media);
					}, 200);
					
					media.addEventListener('timeupdate', function(e) {
						var playbar = $(media).siblings('div.meter')[0];
						var progressbar = $(playbar).children('span')[0];
						var percentComplete = media.currentTime / media.duration * 100;
						$(progressbar).css('width', percentComplete + "%");
						
						var timediv = $(media).siblings('.time-readout')[0];
						var audioCurTime = $(timediv).children('.audioCurrent')[0];
						$(audioCurTime).text(getMinSec(media.currentTime));
						
					}, false);
					
					media.addEventListener('ended', function(e) {
						media.pause();
					}, false);
				}
			
			});
			
			var getMinSec = function (time) {
				var minutes = Math.floor(time / 60);
				var seconds = parseInt(time - minutes * 60);
				if (seconds < 10) seconds = "0" + seconds;
				return minutes + ":" + seconds;
			};
			
		</script>
		
	</body>
</html>